{"version":3,"file":"compiled-all-chats-component.js","names":["axios","io","AllChatsComponent","React","Component","constructor","props","state","connection_status","is_initial","is_online","active_chat_ids","active_chats","user","loaded_chat_id","message_send","is_sending","socketio","socket","custom_data","typing_indicator","throttle_time","can_publish","render","height","renderChats","renderWelcomeScreen","renderMessages","componentDidMount","interval","setInterval","setState","componentWillUnmount","clearInterval","newState","getUser","activeChats","getAllActiveChats","forEach","ch","_id","map","on","console","log","engine","arg","listenCSSASendMessageResponse","listenToggleOnlineStatus","response","listenCloseChatResponse","listenCSSAChatSeenResponse","listenCustomerMessageSend","get","data","error","toggleOnlineStatus","emitToggleOnlineStatus","user_id","loadChat","chat_id","chat","is_seen_by_cssa","emitCSSAChatSeen","loadChatMessagesByChatID","sortChatIDsByUpdateTimestamp","chatIds","sort","a","b","Date","inputMessage","event","value","target","sendMessage","current_chat","message","input_value","emitCSSASendMessage","acknowledgeCSSASendMessage","closeChat","emitCloseChat","publishTypingIndicator","emitCSSATypingIndicator","setTimeout","acknowledge","emit","res","chatMessage","updatedChat","updated_at","push","status","newStatus","content","filter","old_chat","chatMessages","chat_messages","determineChatClass","className","fontSize","first_name","last_name","loaded_chat","loaded_chat_messages","cm","index","is_incoming","customer_name","customer_email","cursor","view","title_question","moment","fromNow","domContainer","document","querySelector","root","ReactDOM","createRoot"],"sources":["all-chats-component.js"],"sourcesContent":["import axios from 'https://cdn.skypack.dev/axios';\r\nimport { io } from 'https://cdn.socket.io/4.4.1/socket.io.esm.min.js';\r\n\r\nclass AllChatsComponent extends React.Component {\r\n\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\tthis.state = {\r\n\t\t\tconnection_status: false,\r\n\t\t\tis_initial: true,\r\n\t\t\tis_online: false,\r\n\t\t\tactive_chat_ids: [],\r\n\t\t\tactive_chats: {},\r\n\t\t\tuser: null,\r\n\t\t\tloaded_chat_id: null,\r\n\t\t\tmessage_send: {\r\n\t\t\t\tis_sending: false\r\n\t\t\t},\r\n\t\t\tsocketio: {\r\n\t\t\t\tsocket: null\r\n\t\t\t},\r\n\t\t};\r\n\t\tthis.custom_data = {\r\n\t\t\ttyping_indicator: {\r\n\t\t\t\tthrottle_time: 1000, //millie seconds\r\n\t\t\t\tcan_publish: true,\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t}\r\n\r\n\r\n\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<React.Fragment>\r\n\t\t\t\t<div className=\"container p-0\">\r\n\t\t\t\t\t{/*<button onClick={this.toggleOnlineStatus}>*/}\r\n\t\t\t\t\t{/*\t{this.state.is_online ? 'Online' : 'Offline'}*/}\r\n\t\t\t\t\t{/*</button>*/}\r\n\t\t\t\t\t<div className=\"row no-gutters\">\r\n\t\t\t\t\t\t<div className=\"col-md-4 border-right\">\r\n\t\t\t\t\t\t\t<div className=\"settings-tray\">\r\n\t\t\t\t\t\t\t\t{/*<img className=\"profile-image\" src=\"https://www.clarity-enhanced.net/wp-content/uploads/2020/06/filip.jpg\" alt=\"Profile img\" />*/}\r\n\t\t\t\t\t\t\t\t<div className=\"h6\">Connection Status-<span className=\"font-weight-bold font-italic\"> { this.state.connection_status ? \"Connected \" : \"Disconnected \"}</span><i className={this.state.connection_status ? 'fa fa-circle text-success': 'fa fa-circle text-danger'}/></div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t{/*<div className=\"search-box\">*/}\r\n\t\t\t\t\t\t\t{/*\t<div className=\"input-wrapper\">*/}\r\n\t\t\t\t\t\t\t{/*\t\t<i className=\"material-icons\">search</i>*/}\r\n\t\t\t\t\t\t\t{/*\t\t<input placeholder=\"Search here\" type=\"text\" />*/}\r\n\t\t\t\t\t\t\t{/*\t</div>*/}\r\n\t\t\t\t\t\t\t{/*</div>*/}\r\n\t\t\t\t\t\t\t<div className=\"overflow-auto\" style={{height: '540px'}}>\r\n\t\t\t\t\t\t\t\t{this.renderChats()}\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t{this.state.is_initial ? this.renderWelcomeScreen() : this.renderMessages()}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</React.Fragment>\r\n\t\t);\r\n\t}\r\n\r\n\tcomponentDidMount() {\r\n\t\t//Update the component every one minute so the relative times will update\r\n\t\tthis.interval = setInterval(() => this.setState({ }), 60000);\r\n\t}\r\n\r\n\tcomponentWillUnmount() {\r\n\t\tclearInterval(this.interval);\r\n\t}\r\n\r\n\tasync componentDidMount() {\r\n\t\tlet newState = {};\r\n\t\tconst user = await this.getUser();\r\n\t\tconst activeChats = await this.getAllActiveChats();\r\n\t\t// console.log(activeChats);\r\n\t\tif(user) {\r\n\t\t\tnewState['is_online'] = user.is_online;\r\n\t\t\tnewState['user'] = user;\r\n\t\t}\r\n\t\tif(activeChats){\r\n\t\t\t//newState['active_chats'] = activeChats;\r\n\t\t\tnewState['active_chats'] = {};\r\n\t\t\tactiveChats.forEach(ch => {\r\n\t\t\t\t// console.log(ch);\r\n\t\t\t\tnewState['active_chats'][ch._id] = ch;\r\n\t\t\t});\r\n\t\t\tnewState['active_chat_ids'] = activeChats.map(ch => ch._id);\r\n\t\t}\r\n\r\n\r\n\t\tthis.setState(newState);\r\n\r\n\t\tconst socket = io('/cssa-messages',{});\r\n\t\tsocket.on(\"connect\", () => {\r\n\t\t\tconsole.log(\"Socket IO Connected.\");\r\n\r\n\t\t\tthis.setState( {connection_status: true, socketio: {socket: socket} } );\r\n\t\t\tconst engine = socket.io.engine;\r\n\t\t});\r\n\r\n\t\t//On Disconnect or Connection Error Event\r\n\t\tsocket.on(\"connect_error\", () => {\r\n\t\t\tconsole.log('connection Error.');\r\n\t\t\tthis.setState({connection_status: false});\r\n\t\t});\r\n\r\n\t\t//Register Event Listeners\r\n\t\tsocket.on('cssa-message-send-response', (arg) => {\r\n\t\t\tthis.listenCSSASendMessageResponse(arg);\r\n\t\t});\r\n\r\n\t\tsocket.on('cssa-toggle-online-status-response', (arg) => {\r\n\t\t\tthis.listenToggleOnlineStatus(arg);\r\n\t\t});\r\n\r\n\t\tsocket.on('cssa-close-chat-response', response => {\r\n\t\t\tthis.listenCloseChatResponse(response);\r\n\t\t})\r\n\r\n\t\tsocket.on('cssa-chat-seen-response', response => {\r\n\t\t\tthis.listenCSSAChatSeenResponse(response);\r\n\t\t});\r\n\r\n\t\tsocket.on('customer-message-send', response => {\r\n\t\t\tthis.listenCustomerMessageSend(response);\r\n\t\t});\r\n\r\n\r\n\t}\r\n\r\n\tgetUser = async () => {\r\n\t\ttry {\r\n\t\t\tconst response = await axios.get('/users/get');\r\n\t\t\treturn response.data;\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(error);\r\n\t\t\treturn null;\r\n\t\t}\r\n\t};\r\n\r\n\tgetAllActiveChats = async () => {\r\n\t\ttry {\r\n\t\t\tconst response = await axios.get('/chats/active-chats-cssa');\r\n\t\t\treturn response.data;\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(error);\r\n\t\t\treturn null;\r\n\t\t}\r\n\t};\r\n\r\n\ttoggleOnlineStatus = () => {\r\n\t\tconst {is_online, user} = this.state;\r\n\r\n\t\tthis.emitToggleOnlineStatus({is_online: !is_online, user_id: user._id, active_chat_ids: this.state.active_chat_ids});\r\n\r\n\t};\r\n\r\n\tloadChat = async (chat_id) => {\r\n\t\tconst newState = {\r\n\t\t\tis_initial: false,\r\n\t\t\tloaded_chat_id: chat_id,\r\n\t\t};\r\n\r\n\t\tlet { active_chats } = this.state;\r\n\t\tlet chat = active_chats[chat_id];\r\n\t\tif(!chat.is_seen_by_cssa) {\r\n\t\t\tactive_chats = {...active_chats};\r\n\t\t\tchat = {...chat};\r\n\t\t\tchat.is_seen_by_cssa = true;\r\n\t\t\tactive_chats[chat_id] = chat;\r\n\t\t\tnewState['active_chats'] = active_chats;\r\n\r\n\t\t\t//notify Others\r\n\t\t\tthis.emitCSSAChatSeen({chat_id});\r\n\t\t}\r\n\r\n\t\tthis.setState(newState);\r\n\t};\r\n\r\n\tloadChatMessagesByChatID = async (chat_id) => {\r\n\t\ttry {\r\n\t\t\tconst response = await axios.get('/chat-messages/get/'+chat_id);\r\n\t\t\treturn response.data;\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(error);\r\n\t\t\treturn null;\r\n\t\t}\r\n\t};\r\n\r\n\tsortChatIDsByUpdateTimestamp = (chatIds, active_chats) => {\r\n\t\tchatIds = [...chatIds];\r\n\t\tchatIds.sort((a,b) => {\r\n\t\t\ta = new Date(active_chats[a]['updated_at']);\r\n\t\t\tb = new Date(active_chats[b]['updated_at']);\r\n\r\n\t\t\tif (a > b) {\r\n\t\t\t\treturn -1;\r\n\t\t\t}\r\n\t\t\tif (a < b) {\r\n\t\t\t\treturn 1;\r\n\t\t\t}\r\n\t\t\treturn 0;\r\n\t\t});\r\n\r\n\t\t// console.log(chatIds);\r\n\t\treturn chatIds;\r\n\t};\r\n\r\n\tinputMessage = (event) => {\r\n\t\tconst {loaded_chat_id, active_chats} = this.state;\r\n\r\n\t\tconst value = event.target.value;\r\n\t\tconst newState = {'active_chats': {...active_chats}};\r\n\t\tnewState['active_chats'][loaded_chat_id]['input_value'] = value;\r\n\r\n\t\tthis.setState(newState);\r\n\t};\r\n\r\n\tsendMessage = () => {\r\n\t\tconst { loaded_chat_id, active_chats} = this.state;\r\n\r\n\t\tconst current_chat = active_chats[loaded_chat_id];\r\n\r\n\t\tconst message = current_chat.input_value ? current_chat.input_value : '';\r\n\r\n\t\tconst data = {\r\n\t\t\tmessage,\r\n\t\t\tchat_id: loaded_chat_id\r\n\t\t}\r\n\r\n\t\tthis.emitCSSASendMessage(data, this.acknowledgeCSSASendMessage);\r\n\r\n\t\tthis.setState({\r\n\t\t\tmessage_send: {\r\n\t\t\t\tis_sending: true\r\n\t\t\t}\r\n\t\t});\r\n\t};\r\n\r\n\tcloseChat = (chat_id) => {\r\n\t\tthis.emitCloseChat({chat_id});\r\n\t};\r\n\r\n\tpublishTypingIndicator = () => {\r\n\t\tif(this.custom_data.typing_indicator.can_publish) {\r\n\t\t\tconst { loaded_chat_id } = this.state;\r\n\t\t\tthis.emitCSSATypingIndicator({chat_id: loaded_chat_id});\r\n\r\n\t\t\tthis.custom_data.typing_indicator.can_publish = false;\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tthis.custom_data.typing_indicator.can_publish = true;\r\n\t\t\t}, this.custom_data.typing_indicator.throttle_time);\r\n\t\t}\r\n\r\n\t};\r\n\r\n\r\n\t//Start - SocketIO Events and EventListeners and Acknowledgements\r\n\temitCSSASendMessage = (message, acknowledge) => {\r\n\t\tconst {socketio} = this.state;\r\n\r\n\t\tsocketio.socket.emit('cssa-message-send', message, acknowledge);\r\n\t}\r\n\r\n\tlistenCSSASendMessageResponse = (res) => {\r\n\t\tconst { chatMessage, chat: updatedChat } = res;\r\n\t\tlet newState = {};\r\n\t\tconst {message_send, active_chats, active_chat_ids} = this.state;\r\n\r\n\t\tif(chatMessage) {\r\n\t\t\tif (message_send.is_sending) {\r\n\t\t\t\tnewState = {\r\n\t\t\t\t\tmessage_send: {\r\n\t\t\t\t\t\tis_sending: false\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t//Add the message to the correct chat\r\n\t\t\tnewState['active_chats'] = {...active_chats};\r\n\t\t\tconst chat = newState['active_chats'][chatMessage.chat_id];\r\n\t\t\tchat['updated_at'] = updatedChat.updated_at;\r\n\t\t\tchat['chat_messages'].push(chatMessage);\r\n\r\n\t\t\tnewState['active_chat_ids'] = this.sortChatIDsByUpdateTimestamp(active_chat_ids, newState['active_chats']);\r\n\r\n\t\t\tthis.setState(newState);\r\n\t\t}\r\n\t};\r\n\r\n\tacknowledgeCSSASendMessage = (response) => {\r\n\t\tif(response.status === 'FAILED')\r\n\t\t\tconsole.log(\"Send Failed.\");\r\n\r\n\t\tconst { chatMessage, chat: updatedChat } = response;\r\n\t\tlet newState = {};\r\n\t\tconst {message_send, active_chats, active_chat_ids} = this.state;\r\n\r\n\t\tif(chatMessage) {\r\n\t\t\tif (message_send.is_sending) {\r\n\t\t\t\tnewState = {\r\n\t\t\t\t\tmessage_send: {\r\n\t\t\t\t\t\tis_sending: false\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t//Add the message to the correct chat\r\n\t\t\tnewState['active_chats'] = {...active_chats};\r\n\t\t\tconst chat = newState['active_chats'][chatMessage.chat_id];\r\n\t\t\tchat['input_value'] = '';\r\n\t\t\tchat['updated_at'] = updatedChat.updated_at;\r\n\t\t\tchat['chat_messages'].push(chatMessage);\r\n\r\n\t\t\tnewState['active_chat_ids'] = this.sortChatIDsByUpdateTimestamp(active_chat_ids, newState['active_chats']);\r\n\r\n\t\t\tthis.setState(newState);\r\n\t\t}\r\n\t}\r\n\r\n\temitToggleOnlineStatus = (newStatus) => {\r\n\t\tconst {socketio} = this.state;\r\n\r\n\t\tsocketio.socket.emit('cssa-toggle-online-status', newStatus);\r\n\t};\r\n\r\n\tlistenToggleOnlineStatus = (response) => {\r\n\t\tthis.setState({\r\n\t\t\tis_online: response.is_online\r\n\t\t});\r\n\t};\r\n\r\n\temitCloseChat = (content) => {\r\n\t\tconst {socketio} = this.state;\r\n\r\n\t\tsocketio.socket.emit('cssa-close-chat', content);\r\n\t};\r\n\r\n\tlistenCloseChatResponse = (response) => {\r\n\t\tif(response.status === 'OK') {\r\n\t\t\tconst chat_id = response.chat_id;\r\n\t\t\tlet { loaded_chat_id, active_chat_ids, active_chats} = this.state;\r\n\r\n\t\t\tactive_chat_ids = active_chat_ids.filter(ch => ch !== chat_id);\r\n\t\t\tactive_chats = {...active_chats};\r\n\t\t\tdelete active_chats[chat_id];\r\n\t\t\tlet newState = {\r\n\t\t\t\tactive_chat_ids,\r\n\t\t\t\tactive_chats\r\n\t\t\t}\r\n\t\t\tif (loaded_chat_id === chat_id)\r\n\t\t\t\tnewState['is_initial'] = true;\r\n\r\n\t\t\t// console.log(newState);\r\n\t\t\tthis.setState(newState);\r\n\t\t}\r\n\t};\r\n\r\n\temitCSSAChatSeen = (content) => {\r\n\t\tconst {socketio} = this.state;\r\n\r\n\t\tsocketio.socket.emit('cssa-chat-seen', content);\r\n\t};\r\n\r\n\tlistenCSSAChatSeenResponse = (response) => {\r\n\t\tconst { status, chat } = response;\r\n\t\tif(status === 'OK') {\r\n\t\t\tlet { active_chats } = this.state;\r\n\t\t\tactive_chats = {...active_chats};\r\n\t\t\tlet old_chat = active_chats[chat._id];\r\n\t\t\tlet chatMessages = old_chat['chat_messages'];\r\n\t\t\tchatMessages = [...chatMessages];\r\n\t\t\tchat.input_value = old_chat.input_value;\r\n\t\t\tchat.chat_messages = chatMessages;\r\n\r\n\t\t\tactive_chats[chat._id] = chat;\r\n\r\n\t\t\tthis.setState({active_chats});\r\n\t\t}\r\n\t};\r\n\r\n\temitCSSATypingIndicator = (content) => {\r\n\t\tconst {socketio} = this.state;\r\n\r\n\t\tsocketio.socket.emit('cssa-typing-indicator-publish', content);\r\n\t};\r\n\r\n\tlistenCustomerMessageSend = response => {\r\n\t\tconst { chatMessage, chat: updatedChat } = response;\r\n\t\tlet newState = {};\r\n\t\tlet { active_chats, active_chat_ids} = this.state;\r\n\r\n\t\tif(chatMessage) {\r\n\t\t\t//Add the message to the correct chat\r\n\t\t\tnewState['active_chats'] = {...active_chats};\r\n\t\t\tlet chat;\r\n\t\t\tif (!newState['active_chats'][chatMessage.chat_id]) {\r\n\t\t\t\t chat = {...updatedChat};\r\n\t\t\t\t chat['chat_messages'] = [];\r\n\t\t\t\t active_chat_ids = [...active_chat_ids];\r\n\t\t\t\t active_chat_ids.push(chatMessage.chat_id);\r\n\t\t\t\t newState['active_chats'][chatMessage.chat_id] = chat;\r\n\t\t\t} else {\r\n\t\t\t\tchat = newState['active_chats'][chatMessage.chat_id];\r\n\t\t\t}\r\n\t\t\tchat['updated_at'] = updatedChat.updated_at;\r\n\t\t\tchat['chat_messages'].push(chatMessage);\r\n\r\n\t\t\tnewState['active_chat_ids'] = this.sortChatIDsByUpdateTimestamp(active_chat_ids, newState['active_chats']);\r\n\r\n\t\t\tthis.setState(newState);\r\n\t\t}\r\n\r\n\t};\r\n\r\n\t//End - SocketIO Events and EventListeners\r\n\r\n\tdetermineChatClass = (chat) => {\r\n\t\tconst { loaded_chat_id } = this.state;\r\n\t\tlet className = 'friend-drawer ';\r\n\t\tif(chat._id === loaded_chat_id) {\r\n\t\t\tclassName += 'friend-drawer--onselected';\r\n\t\t} else if (!chat.is_seen_by_cssa) {\r\n\t\t\tclassName += 'friend-drawer--onnewchats';\r\n\t\t} else {\r\n\t\t\tclassName += 'friend-drawer--onhover';\r\n\t\t}\r\n\r\n\t\treturn className;\r\n\t};\r\n\r\n\trenderWelcomeScreen = () => {\r\n\t\tconst {user} = this.state;\r\n\t\tif (user) {\r\n\t\t\treturn (<div className=\"col-md-8\">\r\n\t\t\t\t<div className=\"settings-tray\">\r\n\t\t\t\t\t<div className=\"friend-drawer no-gutters friend-drawer--grey\">\r\n\t\t\t\t\t\t{/*<img className=\"profile-image\"*/}\r\n\t\t\t\t\t\t{/*\t src=\"https://www.clarity-enhanced.net/wp-content/uploads/2020/06/robocop.jpg\" alt=\"\"/>*/}\r\n\t\t\t\t\t\t<i className='fa fa-user-circle' style={{fontSize: '40px'}}/>\r\n\t\t\t\t\t\t<div className=\"text\">\r\n\t\t\t\t\t\t\t<h6>Welcome, {user.first_name}</h6>\r\n\t\t\t\t\t\t\t<p className=\"text-muted\">{user.first_name + ' ' + user.last_name+ ' - ' + 'CSSA'}</p>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<span className=\"settings-tray--right\">\r\n\t\t\t\t\t\t   <label className=\"switch\">\r\n\t\t\t\t\t\t\t\t<input type=\"checkbox\" onClick={() => {this.toggleOnlineStatus()}}  checked={this.state.is_online}/>\r\n  \t\t\t\t\t\t\t\t<span className=\"slider round1\"/>\r\n\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t\t<span className=\"p-2 font-weight-bold\">{this.state.is_online? 'Online': 'Offline'}</span>\r\n\t\t\t\t\t\t</span>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>);\r\n\t\t}\r\n\t};\r\n\r\n\trenderMessages = () => {\r\n\r\n\r\n\t\tconst { loaded_chat_id, active_chats, message_send } = this.state;\r\n\r\n\t\tconst loaded_chat = active_chats[loaded_chat_id];\r\n\t\tconst loaded_chat_messages = active_chats[loaded_chat_id]['chat_messages'];\r\n\t\tconst chatMessages = loaded_chat_messages.map((cm, index) => {\r\n\t\t\t//left\r\n\t\t\tif(cm.is_incoming) {\r\n\t\t\t\treturn (\r\n\t\t\t\t\t<div key={cm._id} className=\"row no-gutters\">\r\n\t\t\t\t\t\t<div className=\"col-md-6\">\r\n\t\t\t\t\t\t\t<div className=\"chat-bubble chat-bubble--left\">\r\n\t\t\t\t\t\t\t\t{cm.message}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t);\r\n\t\t\t} else {\r\n\t\t\t\t//right\r\n\t\t\t\treturn (\r\n\t\t\t\t\t<div key={cm._id} className=\"row no-gutters\">\r\n\t\t\t\t\t\t<div className=\"col-md-6 offset-md-6\">\r\n\t\t\t\t\t\t\t<div className=\"chat-bubble chat-bubble--right\">\r\n\t\t\t\t\t\t\t\t{cm.message}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\treturn (\r\n\t\t\t<div className=\"col-md-8\">\r\n\t\t\t\t<div className=\"settings-tray\">\r\n\t\t\t\t\t<div className=\"friend-drawer no-gutters friend-drawer--grey\">\r\n\t\t\t\t\t\t{/*<img className=\"profile-image\"*/}\r\n\t\t\t\t\t\t{/*\t src=\"https://www.clarity-enhanced.net/wp-content/uploads/2020/06/robocop.jpg\" alt=\"\"/>*/}\r\n\t\t\t\t\t\t<i className='fa fa-user-circle' style={{fontSize: '40px'}}/>\r\n\t\t\t\t\t\t<div className=\"text\">\r\n\t\t\t\t\t\t\t<h6>{loaded_chat.customer_name}</h6>\r\n\t\t\t\t\t\t\t<p className=\"text-muted\">Email - {loaded_chat.customer_email}</p>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<span className=\"settings-tray--right\">\r\n\t\t\t\t\t\t\t<label className=\"switch\">\r\n\t\t\t\t\t\t\t\t<input type=\"checkbox\" onClick={() => {this.toggleOnlineStatus()}}  checked={this.state.is_online}/>\r\n  \t\t\t\t\t\t\t\t<span className=\"slider round1\"/>\r\n\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t\t<span className=\"p-2 font-weight-bold\">{this.state.is_online? 'Online': 'Offline'}</span>\r\n                \t\t</span>\r\n\t\t\t\t\t\t<i className=\"material-icons ml-4 cursor font-weight-bold\" style={{cursor: 'pointer'}} onClick={() => this.closeChat(loaded_chat._id)}>close</i>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"chat-panel\">\r\n\t\t\t\t\t<div className='overflow-auto' style={{height: '480px'}}>\r\n\t\t\t\t\t\t{chatMessages}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"row\">\r\n\t\t\t\t\t\t<div className=\"col-12\">\r\n\t\t\t\t\t\t\t<div className=\"chat-box-tray\">\r\n\t\t\t\t\t\t\t\t<i className=\"material-icons\">s</i>\r\n\t\t\t\t\t\t\t\t<input onChange={this.inputMessage} onKeyUp={this.publishTypingIndicator} type=\"text\" value={loaded_chat.input_value ? loaded_chat.input_value : ''} placeholder=\"Type your message here...\"/>\r\n\t\t\t\t\t\t\t\t<i className=\"material-icons\">mic</i>\r\n\t\t\t\t\t\t\t\t<button onClick={this.sendMessage} disabled={message_send.is_sending} className=\"round\">Send</button>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t);\r\n\t};\r\n\r\n\trenderChats = () => {\r\n\t\tconst {active_chats, active_chat_ids, loaded_chat_id} = this.state;\r\n\r\n\t\tlet view;\r\n\r\n\t\tview = active_chat_ids.map((chat_id,index) => {\r\n\t\t\tconst chat = active_chats[chat_id];\r\n\t\t\treturn (\r\n\t\t\t\t<React.Fragment key={chat._id}>\r\n\t\t\t\t\t<div className={this.determineChatClass(chat)} onClick={() => this.loadChat(chat._id)}>\r\n\t\t\t\t\t\t{/*<img className=\"profile-image\" src=\"https://www.clarity-enhanced.net/wp-content/uploads/2020/06/robocop.jpg\" alt=\"\" />*/}\r\n\t\t\t\t\t\t<i className='fa fa-user-circle' style={{fontSize: '40px'}}/>\r\n\t\t\t\t\t\t<div className=\"text\">\r\n\t\t\t\t\t\t\t<h6>{chat.customer_name} {!chat.is_seen_by_cssa ? <span className=\"badge badge-success\">New</span> : ''}</h6>\r\n\t\t\t\t\t\t\t<p className=\"text-muted\">{chat.title_question}</p>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<span className=\"time text-muted small\">{moment(chat.updated_at).fromNow()}</span>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<hr />\r\n\t\t\t\t</React.Fragment>\r\n\t\t\t);\r\n\t\t});\r\n\r\n\t\treturn view;\r\n\t};\r\n}\r\n\r\nconst domContainer = document.querySelector('#react-all-chats-component');\r\nconst root = ReactDOM.createRoot(domContainer);\r\nroot.render(<AllChatsComponent />);"],"mappings":"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"}